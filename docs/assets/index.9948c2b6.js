import{b as it,d as ft}from"./index.364dcebf.js";function ot(a,c){function r(){this.constructor=a}r.prototype=c.prototype,a.prototype=new r}function I(a,c,r,$){var v=Error.call(this,a);return Object.setPrototypeOf&&Object.setPrototypeOf(v,I.prototype),v.expected=c,v.found=r,v.location=$,v.name="SyntaxError",v}ot(I,Error);function X(a,c,r){return r=r||" ",a.length>c?a:(c-=a.length,r+=r.repeat(c),a+r.slice(0,c))}I.prototype.format=function(a){var c="peg error: "+this.message;if(this.location){var r=null,$;for($=0;$<a.length;$++)if(a[$].source===this.location.source){r=a[$].text.split(/\r\n|\n|\r/g);break}var v=this.location.start,_=this.location.source+":"+v.line+":"+v.column;if(r){var A=this.location.end,y=X("",v.line.toString().length," "),w=r[v.line-1],h=v.line===A.line?A.column:w.length+1,m=h-v.column||1;c+=`
 --> `+_+`
`+y+` |
`+v.line+" | "+w+`
`+y+" | "+X("",v.column-1," ")+X("",m,"^")}else c+=`
 at `+_}return c};I.buildMessage=function(a,c){var r={literal:function(h){return'"'+v(h.text)+'"'},class:function(h){var m=h.parts.map(function(C){return Array.isArray(C)?_(C[0])+"-"+_(C[1]):_(C)});return"["+(h.inverted?"^":"")+m.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(h){return h.description}};function $(h){return h.charCodeAt(0).toString(16).toUpperCase()}function v(h){return h.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(m){return"\\x0"+$(m)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(m){return"\\x"+$(m)})}function _(h){return h.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(m){return"\\x0"+$(m)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(m){return"\\x"+$(m)})}function A(h){return r[h.type](h)}function y(h){var m=h.map(A),C,F;if(m.sort(),m.length>0){for(C=1,F=1;C<m.length;C++)m[C-1]!==m[C]&&(m[F]=m[C],F++);m.length=F}switch(m.length){case 1:return m[0];case 2:return m[0]+" or "+m[1];default:return m.slice(0,-1).join(", ")+", or "+m[m.length-1]}}function w(h){return h?'"'+v(h)+'"':"end of input"}return"Expected "+y(a)+" but "+w(c)+" found."};function Fe(a,c){c=c!==void 0?c:{};var r={},$=c.grammarSource,v={start:Ae},_=Ae,A=".",y="-",w="+",h="0",m=",",C="|",F='"',Re="'",Pe="#",qe="^",Oe="_",De=":",J="[",K="]",Ie="<",ke=">",Ne="@",Be="!",Te="(",ze=")",Le="/",Me="*",Ze="%",Ge="?",Q="struct",V="target",W="euclid",Y="slow",ee="rotL",re="rotR",se="fast",te="scale",ne="//",ae="cat",Ue="$",ie="setcps",fe="setbpm",oe="hush",Xe=/^[1-9]/,He=/^[eE]/,Je=/^[0-9]/,ce=/^[ \n\r\t]/,Ke=/^[0-9a-zA-Z~]/,le=/^[^\n]/,Qe=_e("number"),ue=p(".",!1),Ve=j([["1","9"]],!1,!1),We=j(["e","E"],!1,!1),pe=p("-",!1),Ye=p("+",!1),er=p("0",!1),rr=j([["0","9"]],!1,!1),sr=_e("whitespace"),ge=j([" ",`
`,"\r","	"],!1,!1),tr=p(",",!1),nr=p("|",!1),ar=p('"',!1),ir=p("'",!1),fr=j([["0","9"],["a","z"],["A","Z"],"~"],!1,!1),or=p("#",!1),cr=p("^",!1),lr=p("_",!1),ur=p(":",!1),ve=p("[",!1),$e=p("]",!1),pr=p("<",!1),gr=p(">",!1),vr=p("@",!1),$r=p("!",!1),hr=p("(",!1),mr=p(")",!1),_r=p("/",!1),dr=p("*",!1),Ar=p("%",!1),wr=p("?",!1),yr=p("struct",!1),br=p("target",!1),Cr=p("euclid",!1),xr=p("slow",!1),Er=p("rotL",!1),Fr=p("rotR",!1),jr=p("fast",!1),Sr=p("scale",!1),Rr=p("//",!1),he=j([`
`],!0,!1),Pr=p("cat",!1),qr=p("$",!1),Or=p("setcps",!1),Dr=p("setbpm",!1),Ir=p("hush",!1),kr=function(){return parseFloat($s())},Nr=function(e){return e.join("")},Br=function(e){return e},Tr=function(e){return e.arguments_.alignment="t",e},zr=function(e){return{weight:e}},Lr=function(e){return{replicate:e}},Mr=function(e,t,n){return{operator:{type_:"bjorklund",arguments_:{pulse:e,step:t,rotation:n||0}}}},Zr=function(e){return{operator:{type_:"stretch",arguments_:{amount:e}}}},Gr=function(e){return{operator:{type_:"stretch",arguments_:{amount:"1/"+e}}}},Ur=function(e){return{operator:{type_:"fixed-step",arguments_:{amount:e}}}},Xr=function(e){return{operator:{type_:"degradeBy",arguments_:{amount:e||.5}}}},Hr=function(e,t){return new at(e,t)},Jr=function(e){return new G(e,"h")},Kr=function(e){return{alignment:"v",list:e}},Qr=function(e){return{alignment:"r",list:e}},Vr=function(e,t){return t&&t.list.length>0?new G([e,...t.list],t.alignment):e},Wr=function(e){return e},Yr=function(e){return{name:"struct",args:{sequence:e}}},es=function(e){return{name:"target",args:{name:e}}},rs=function(e,t,n){return{name:"bjorklund",args:{pulse:parseInt(e),step:parseInt(t)}}},ss=function(e){return{name:"stretch",args:{amount:e}}},ts=function(e){return{name:"shift",args:{amount:"-"+e}}},ns=function(e){return{name:"shift",args:{amount:e}}},as=function(e){return{name:"stretch",args:{amount:"1/"+e}}},is=function(e){return{name:"scale",args:{scale:e.join("")}}},me=function(e,t){return t},fs=function(e,t){return t.unshift(e),new G(t,"t")},os=function(e){return e},cs=function(e,t){return new nt(e.name,e.args,t)},ls=function(e){return e},us=function(e){return e},ps=function(e){return new U("setcps",{value:e})},gs=function(e){return new U("setcps",{value:e/120/2})},vs=function(){return new U("hush")},s=0,g=0,N=[{line:1,column:1}],E=0,L=[],f=0,B;if("startRule"in c){if(!(c.startRule in v))throw new Error(`Can't start parsing from rule "`+c.startRule+'".');_=v[c.startRule]}function $s(){return a.substring(g,s)}function hs(){return M(g,s)}function p(e,t){return{type:"literal",text:e,ignoreCase:t}}function j(e,t,n){return{type:"class",parts:e,inverted:t,ignoreCase:n}}function ms(){return{type:"end"}}function _e(e){return{type:"other",description:e}}function de(e){var t=N[e],n;if(t)return t;for(n=e-1;!N[n];)n--;for(t=N[n],t={line:t.line,column:t.column};n<e;)a.charCodeAt(n)===10?(t.line++,t.column=1):t.column++,n++;return N[e]=t,t}function M(e,t){var n=de(e),i=de(t);return{source:$,start:{offset:e,line:n.line,column:n.column},end:{offset:t,line:i.line,column:i.column}}}function o(e){s<E||(s>E&&(E=s,L=[]),L.push(e))}function _s(e,t,n){return new I(I.buildMessage(e,t),e,t,n)}function Ae(){var e;return e=tt(),e}function b(){var e,t;return f++,e=s,we(),t=T(),t!==r?(bs(),ys(),g=e,e=kr()):(s=e,e=r),f--,e===r&&f===0&&o(Qe),e}function ds(){var e;return a.charCodeAt(s)===46?(e=A,s++):(e=r,f===0&&o(ue)),e}function As(){var e;return Xe.test(a.charAt(s))?(e=a.charAt(s),s++):(e=r,f===0&&o(Ve)),e}function ws(){var e;return He.test(a.charAt(s))?(e=a.charAt(s),s++):(e=r,f===0&&o(We)),e}function ys(){var e,t,n,i,l;if(e=s,t=ws(),t!==r){if(n=we(),n===r&&(n=Cs()),n===r&&(n=null),i=[],l=S(),l!==r)for(;l!==r;)i.push(l),l=S();else i=r;i!==r?(t=[t,n,i],e=t):(s=e,e=r)}else s=e,e=r;return e}function bs(){var e,t,n,i;if(e=s,t=ds(),t!==r){if(n=[],i=S(),i!==r)for(;i!==r;)n.push(i),i=S();else n=r;n!==r?(t=[t,n],e=t):(s=e,e=r)}else s=e,e=r;return e}function T(){var e,t,n,i;if(e=xs(),e===r)if(e=s,t=As(),t!==r){for(n=[],i=S();i!==r;)n.push(i),i=S();t=[t,n],e=t}else s=e,e=r;return e}function we(){var e;return a.charCodeAt(s)===45?(e=y,s++):(e=r,f===0&&o(pe)),e}function Cs(){var e;return a.charCodeAt(s)===43?(e=w,s++):(e=r,f===0&&o(Ye)),e}function xs(){var e;return a.charCodeAt(s)===48?(e=h,s++):(e=r,f===0&&o(er)),e}function S(){var e;return Je.test(a.charAt(s))?(e=a.charAt(s),s++):(e=r,f===0&&o(rr)),e}function u(){var e,t;for(f++,e=[],ce.test(a.charAt(s))?(t=a.charAt(s),s++):(t=r,f===0&&o(ge));t!==r;)e.push(t),ce.test(a.charAt(s))?(t=a.charAt(s),s++):(t=r,f===0&&o(ge));return f--,t=r,f===0&&o(sr),e}function R(){var e,t,n,i;return e=s,t=u(),a.charCodeAt(s)===44?(n=m,s++):(n=r,f===0&&o(tr)),n!==r?(i=u(),t=[t,n,i],e=t):(s=e,e=r),e}function ye(){var e,t,n,i;return e=s,t=u(),a.charCodeAt(s)===124?(n=C,s++):(n=r,f===0&&o(nr)),n!==r?(i=u(),t=[t,n,i],e=t):(s=e,e=r),e}function P(){var e;return a.charCodeAt(s)===34?(e=F,s++):(e=r,f===0&&o(ar)),e===r&&(a.charCodeAt(s)===39?(e=Re,s++):(e=r,f===0&&o(ir))),e}function z(){var e;return Ke.test(a.charAt(s))?(e=a.charAt(s),s++):(e=r,f===0&&o(fr)),e===r&&(a.charCodeAt(s)===45?(e=y,s++):(e=r,f===0&&o(pe)),e===r&&(a.charCodeAt(s)===35?(e=Pe,s++):(e=r,f===0&&o(or)),e===r&&(a.charCodeAt(s)===46?(e=A,s++):(e=r,f===0&&o(ue)),e===r&&(a.charCodeAt(s)===94?(e=qe,s++):(e=r,f===0&&o(cr)),e===r&&(a.charCodeAt(s)===95?(e=Oe,s++):(e=r,f===0&&o(lr)),e===r&&(a.charCodeAt(s)===58?(e=De,s++):(e=r,f===0&&o(ur)))))))),e}function be(){var e,t,n;if(e=s,u(),t=[],n=z(),n!==r)for(;n!==r;)t.push(n),n=z();else t=r;return t!==r?(n=u(),g=e,e=Nr(t)):(s=e,e=r),e}function Es(){var e,t,n,i;return e=s,u(),a.charCodeAt(s)===91?(t=J,s++):(t=r,f===0&&o(ve)),t!==r?(u(),n=xe(),n!==r?(u(),a.charCodeAt(s)===93?(i=K,s++):(i=r,f===0&&o($e)),i!==r?(u(),g=e,e=Br(n)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r),e}function Fs(){var e,t,n,i;return e=s,u(),a.charCodeAt(s)===60?(t=Ie,s++):(t=r,f===0&&o(pr)),t!==r?(u(),n=q(),n!==r?(u(),a.charCodeAt(s)===62?(i=ke,s++):(i=r,f===0&&o(gr)),i!==r?(u(),g=e,e=Tr(n)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r),e}function js(){var e;return e=be(),e===r&&(e=Es(),e===r&&(e=Fs())),e}function Ss(){var e;return e=Rs(),e===r&&(e=qs(),e===r&&(e=Os(),e===r&&(e=Ds(),e===r&&(e=Is(),e===r&&(e=Ps(),e===r&&(e=ks())))))),e}function Rs(){var e,t,n;return e=s,a.charCodeAt(s)===64?(t=Ne,s++):(t=r,f===0&&o(vr)),t!==r?(n=b(),n!==r?(g=e,e=zr(n)):(s=e,e=r)):(s=e,e=r),e}function Ps(){var e,t,n;return e=s,a.charCodeAt(s)===33?(t=Be,s++):(t=r,f===0&&o($r)),t!==r?(n=b(),n!==r?(g=e,e=Lr(n)):(s=e,e=r)):(s=e,e=r),e}function qs(){var e,t,n,i,l,d,x;return e=s,a.charCodeAt(s)===40?(t=Te,s++):(t=r,f===0&&o(hr)),t!==r?(u(),n=b(),n!==r?(u(),i=R(),i!==r?(u(),l=b(),l!==r?(u(),R(),u(),d=b(),d===r&&(d=null),u(),a.charCodeAt(s)===41?(x=ze,s++):(x=r,f===0&&o(mr)),x!==r?(g=e,e=Mr(n,l,d)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r),e}function Os(){var e,t,n;return e=s,a.charCodeAt(s)===47?(t=Le,s++):(t=r,f===0&&o(_r)),t!==r?(n=b(),n!==r?(g=e,e=Zr(n)):(s=e,e=r)):(s=e,e=r),e}function Ds(){var e,t,n;return e=s,a.charCodeAt(s)===42?(t=Me,s++):(t=r,f===0&&o(dr)),t!==r?(n=b(),n!==r?(g=e,e=Gr(n)):(s=e,e=r)):(s=e,e=r),e}function Is(){var e,t,n;return e=s,a.charCodeAt(s)===37?(t=Ze,s++):(t=r,f===0&&o(Ar)),t!==r?(n=b(),n!==r?(g=e,e=Ur(n)):(s=e,e=r)):(s=e,e=r),e}function ks(){var e,t,n;return e=s,a.charCodeAt(s)===63?(t=Ge,s++):(t=r,f===0&&o(wr)),t!==r?(n=b(),n===r&&(n=null),g=e,e=Xr(n)):(s=e,e=r),e}function Ce(){var e,t,n;return e=s,t=js(),t!==r?(n=Ss(),n===r&&(n=null),g=e,e=Hr(t,n)):(s=e,e=r),e}function q(){var e,t,n;if(e=s,t=[],n=Ce(),n!==r)for(;n!==r;)t.push(n),n=Ce();else t=r;return t!==r&&(g=e,t=Jr(t)),e=t,e}function Ns(){var e,t,n,i,l;if(e=s,t=[],n=s,i=R(),i!==r?(l=q(),l!==r?n=l:(s=n,n=r)):(s=n,n=r),n!==r)for(;n!==r;)t.push(n),n=s,i=R(),i!==r?(l=q(),l!==r?n=l:(s=n,n=r)):(s=n,n=r);else t=r;return t!==r&&(g=e,t=Kr(t)),e=t,e}function Bs(){var e,t,n,i,l;if(e=s,t=[],n=s,i=ye(),i!==r?(l=q(),l!==r?n=l:(s=n,n=r)):(s=n,n=r),n!==r)for(;n!==r;)t.push(n),n=s,i=ye(),i!==r?(l=q(),l!==r?n=l:(s=n,n=r)):(s=n,n=r);else t=r;return t!==r&&(g=e,t=Qr(t)),e=t,e}function xe(){var e,t,n;return e=s,t=q(),t!==r?(n=Ns(),n===r&&(n=Bs()),n===r&&(n=null),g=e,e=Vr(t,n)):(s=e,e=r),e}function Ts(){var e,t,n,i;return e=s,u(),t=P(),t!==r?(n=xe(),n!==r?(i=P(),i!==r?(g=e,e=Wr(n)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r),e}function zs(){var e;return e=Js(),e===r&&(e=Gs(),e===r&&(e=Hs(),e===r&&(e=Ms(),e===r&&(e=Zs(),e===r&&(e=Ls(),e===r&&(e=Xs(),e===r&&(e=Us()))))))),e}function Ls(){var e,t,n;return e=s,a.substr(s,6)===Q?(t=Q,s+=6):(t=r,f===0&&o(yr)),t!==r?(u(),n=O(),n!==r?(g=e,e=Yr(n)):(s=e,e=r)):(s=e,e=r),e}function Ms(){var e,t,n,i,l;return e=s,a.substr(s,6)===V?(t=V,s+=6):(t=r,f===0&&o(br)),t!==r?(u(),n=P(),n!==r?(i=be(),i!==r?(l=P(),l!==r?(g=e,e=es(i)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r),e}function Zs(){var e,t,n,i;return e=s,a.substr(s,6)===W?(t=W,s+=6):(t=r,f===0&&o(Cr)),t!==r?(u(),n=T(),n!==r?(u(),i=T(),i!==r?(u(),T(),g=e,e=rs(n,i)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r),e}function Gs(){var e,t,n;return e=s,a.substr(s,4)===Y?(t=Y,s+=4):(t=r,f===0&&o(xr)),t!==r?(u(),n=b(),n!==r?(g=e,e=ss(n)):(s=e,e=r)):(s=e,e=r),e}function Us(){var e,t,n;return e=s,a.substr(s,4)===ee?(t=ee,s+=4):(t=r,f===0&&o(Er)),t!==r?(u(),n=b(),n!==r?(g=e,e=ts(n)):(s=e,e=r)):(s=e,e=r),e}function Xs(){var e,t,n;return e=s,a.substr(s,4)===re?(t=re,s+=4):(t=r,f===0&&o(Fr)),t!==r?(u(),n=b(),n!==r?(g=e,e=ns(n)):(s=e,e=r)):(s=e,e=r),e}function Hs(){var e,t,n;return e=s,a.substr(s,4)===se?(t=se,s+=4):(t=r,f===0&&o(jr)),t!==r?(u(),n=b(),n!==r?(g=e,e=as(n)):(s=e,e=r)):(s=e,e=r),e}function Js(){var e,t,n,i,l;if(e=s,a.substr(s,5)===te?(t=te,s+=5):(t=r,f===0&&o(Sr)),t!==r)if(u(),n=P(),n!==r){if(i=[],l=z(),l!==r)for(;l!==r;)i.push(l),l=z();else i=r;i!==r?(l=P(),l!==r?(g=e,e=is(i)):(s=e,e=r)):(s=e,e=r)}else s=e,e=r;else s=e,e=r;return e}function Z(){var e,t,n,i;if(e=s,a.substr(s,2)===ne?(t=ne,s+=2):(t=r,f===0&&o(Rr)),t!==r){for(n=[],le.test(a.charAt(s))?(i=a.charAt(s),s++):(i=r,f===0&&o(he));i!==r;)n.push(i),le.test(a.charAt(s))?(i=a.charAt(s),s++):(i=r,f===0&&o(he));t=[t,n],e=t}else s=e,e=r;return e}function Ks(){var e,t,n,i,l,d,x,D;if(e=s,a.substr(s,3)===ae?(t=ae,s+=3):(t=r,f===0&&o(Pr)),t!==r)if(u(),a.charCodeAt(s)===91?(n=J,s++):(n=r,f===0&&o(ve)),n!==r)if(u(),i=O(),i!==r){for(l=[],d=s,x=R(),x!==r?(D=O(),D!==r?(g=d,d=me(i,D)):(s=d,d=r)):(s=d,d=r);d!==r;)l.push(d),d=s,x=R(),x!==r?(D=O(),D!==r?(g=d,d=me(i,D)):(s=d,d=r)):(s=d,d=r);d=u(),a.charCodeAt(s)===93?(x=K,s++):(x=r,f===0&&o($e)),x!==r?(g=e,e=fs(i,l)):(s=e,e=r)}else s=e,e=r;else s=e,e=r;else s=e,e=r;return e}function Qs(){var e;return e=Ks(),e===r&&(e=Ts()),e}function O(){var e,t,n,i,l;if(e=s,t=Qs(),t!==r){for(u(),n=[],i=Z();i!==r;)n.push(i),i=Z();g=e,e=os(t)}else s=e,e=r;return e===r&&(e=s,t=zs(),t!==r?(u(),a.charCodeAt(s)===36?(n=Ue,s++):(n=r,f===0&&o(qr)),n!==r?(i=u(),l=O(),l!==r?(g=e,e=cs(t,l)):(s=e,e=r)):(s=e,e=r)):(s=e,e=r)),e}function Vs(){var e,t;return e=s,t=O(),t!==r&&(g=e,t=ls(t)),e=t,e===r&&(e=Z()),e}function Ws(){var e;return e=Vs(),e}function Ys(){var e,t;return e=s,u(),t=et(),t===r&&(t=rt(),t===r&&(t=st())),t!==r?(u(),g=e,e=us(t)):(s=e,e=r),e}function et(){var e,t,n;return e=s,a.substr(s,6)===ie?(t=ie,s+=6):(t=r,f===0&&o(Or)),t!==r?(u(),n=b(),n!==r?(g=e,e=ps(n)):(s=e,e=r)):(s=e,e=r),e}function rt(){var e,t,n;return e=s,a.substr(s,6)===fe?(t=fe,s+=6):(t=r,f===0&&o(Dr)),t!==r?(u(),n=b(),n!==r?(g=e,e=gs(n)):(s=e,e=r)):(s=e,e=r),e}function st(){var e,t;return e=s,a.substr(s,4)===oe?(t=oe,s+=4):(t=r,f===0&&o(Ir)),t!==r&&(g=e,t=vs()),e=t,e}function tt(){var e;return e=Ws(),e===r&&(e=Ys()),e}var G=function(e,t){this.type_="pattern",this.arguments_={alignment:t},this.source_=e},nt=function(e,t,n){this.type_=e,this.arguments_=t,this.source_=n},at=function(e,t){this.type_="element",this.source_=e,this.options_=t,this.location_=hs()},U=function(e,t){this.type_="command",this.name_=e,this.options_=t};if(B=_(),B!==r&&s===a.length)return B;throw B!==r&&s<a.length&&o(ms()),_s(L,E<a.length?a.charAt(E):null,E<a.length?M(E,E+1):M(E,E))}const{pure:ct,Fraction:je,stack:lt,slowcat:ut,sequence:Se,timeCat:pt,silence:Ee,reify:H}=ft,gt=a=>(c,r)=>{var y;const v=a.source_[r].options_,_=v==null?void 0:v.operator;if(_){switch(_.type_){case"stretch":{const w=je(_.arguments_.amount).inverse();return H(c).fast(w)}case"bjorklund":return c.euclid(_.arguments_.pulse,_.arguments_.step,_.arguments_.rotation);case"degradeBy":return H(c)._degradeBy((y=_.arguments_.amount)!=null?y:.5)}console.warn(`operator "${_.type_}" not implemented`)}if(v!=null&&v.weight)return c;const A=Object.keys(v||{}).filter(w=>w!=="operator");return A.length&&console.warn(`option${A.length>1?"s":""} ${A.map(w=>`"${w}"`).join(", ")} not implemented`),c};function vt(a){a.source_=a.source_.map(c=>{const{replicate:r,...$}=c.options_||{};return r?{...c,options_:{...$,weight:r},source_:{type_:"pattern",arguments_:{alignment:"h"},source_:[{type_:"element",source_:c.source_,location_:c.location_,options_:{operator:{type_:"stretch",arguments_:{amount:je(r).inverse().toString()}}}}]}}:c})}function k(a,c){switch(a.type_){case"pattern":{vt(a);const r=a.source_.map(_=>k(_,c)).map(gt(a)),$=a.arguments_.alignment;if($==="v")return lt(...r);if($==="r")return it(...r);const v=a.source_.some(_=>{var A;return!!((A=_.options_)!=null&&A.weight)});if(!v&&$==="t")return ut(...r);if(v){const _=pt(...a.source_.map((A,y)=>{var w;return[((w=A.options_)==null?void 0:w.weight)||1,r[y]]}));if($==="t"){const A=a.source_.reduce((y,w)=>{var h;return y+(((h=w.options_)==null?void 0:h.weight)||1)},0);return _._slow(A)}return _}return Se(...r)}case"element":{if(a.source_==="~")return Ee;if(typeof a.source_!="object"){if(!a.location_)return console.warn("no location for",a),a.source_;const{start:r,end:$}=a.location_,v=isNaN(Number(a.source_))?a.source_:Number(a.source_),_=c==null?void 0:c.split("").slice(r.offset,$.offset).join(""),[A=0,y=0]=_?_.split(a.source_).map(w=>w.split("").filter(h=>h===" ").length):[];return ct(v).withLocation([r.line,r.column+A,r.offset+A],[r.line,$.column-y,$.offset-y])}return k(a.source_,c)}case"stretch":return k(a.source_,c).slow(a.arguments_.amount);default:return console.warn(`node type "${a.type_}" not implemented -> returning silence`),Ee}}const $t=(...a)=>{const c=a.map(r=>{const $=`"${r}"`,v=Fe($);return k(v,$)});return Se(...c)},mt=a=>{const c=Fe(a);return k(c,a)};function _t(a){return typeof a=="string"?$t(a):H(a)}export{I as SyntaxError,mt as h,$t as mini,_t as minify,Fe as parse,k as patternifyAST};
//# sourceMappingURL=index.9948c2b6.js.map
